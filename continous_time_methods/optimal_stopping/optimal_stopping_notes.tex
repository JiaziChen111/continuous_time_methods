\documentclass[11pt]{etk-article}
\usepackage{pstool} 
\usepackage{etk-bib}
\usepackage{amsmath}
\pdfmetadata{}{}{}{}

\begin{document}
\title{Notes on Numerical Solutions for Optimal Stopping Problems}
\date{\today}
\maketitle
These notes expand on Ben Moll's superb notes in \url{http://www.princeton.edu/~moll/HACTproject/} and in particular \url{http://www.princeton.edu/~moll/HACTproject/option_simple.pdf} solving option value problems as HJB Variational Inequalities.  The approach is based on \cite{HuangPang1998}

\textbf{TODO:}
\begin{itemize}
	\item We probably want to put most of the \url{http://www.princeton.edu/~moll/HACTproject/option_simple.pdf} notes in there, but adding in the details on the discretization, boundary values, upwind finite differences, etc. that come from \url{http://www.princeton.edu/~moll/HACTproject/HACT_Numerical_Appendix.pdf} and \url{http://www.princeton.edu/~moll/HACTproject/HACT_Additional_Codes.pdf} as required.
	\item Want to have every formula used in the matlab code explicitly listed, with special care on the boundary values/etc.
\end{itemize}

The "upwind scheme" is constructed by using $X_i$ $Y_i$ and $Z_i$ , where $i = 1, 2, ... , N_X$. Here the idea is to use forward difference approximation whenever the drift of the state variable is positive and the backward difference approximation whenever it is negative.

\begin{align}
	X_i &= - \dfrac{\min ( \mu_i , 0 )}{\Delta} + \dfrac{\sigma_i^{2}}{2 \times \Delta^{2}} \\
	Y &= - \dfrac{\max ( \mu_i , 0)}{\Delta} + \dfrac{\min ( \mu_i , 0)}{\Delta} - \dfrac{\sigma_i^{2}}{\Delta^{2}} \\
	Z &= \dfrac{\max ( \mu_i , 0)}{\Delta} + \dfrac{\sigma_i^{2}}{2\times \Delta^{2}}
\end{align}


By using $X_i$ $Y_i$ and $Z_i$, the matrix $A$ is contructed as 

\begin{equation}
A = \begin{bmatrix}
Y_1 & Z_1 & 0 & \cdots & \cdots & \cdots & 0 \\
X_2 & Y_2 & Z_2 & \ddots & & & \vdots \\
\vdots & \ddots & \ddots & \ddots & \ddots &  & \vdots \\
\vdots & &\ddots & \ddots & \ddots & \ddots  & \vdots \\
\vdots & & & \ddots & X_{N_X-1} & Y_{N_X-1}  & Z_{N_X-1} \\
\vdots & \cdots & \cdots & \cdots & \cdots & X_{N_X} & Y_{N_X}+\dfrac{\sigma_{N_X}^2}{2\Delta^2}\\
\end{bmatrix}
\end{equation}

At the boundaries in the i dimension, the equations become 
\begin{equation}
\rho v_i = u_i + \mu_i \dfrac{v_i-v_{i-1}}{\Delta} + \dfrac{\sigma_i^2}{2} \dfrac{v_{i+1} - 2v_i + v_{i-1}}{\Delta^2}
\end{equation}
As $i =1$, the equations becomes
\begin{equation}
\rho v_1 = u_1 + \mu_1 \dfrac{v_1}{\Delta} + \dfrac{\sigma_1^2}{2} \dfrac{v_{2} - 2v_1}{\Delta^2}
\end{equation}
where we have used $v_0 = 0$. In general, this assumption implies the continuity at $v_1$ and hence $v_1 = v_0$.\\
As $i=N_X$, the equation becomes
\begin{equation}
\rho v_{N_X} = u_{N_X} + \mu_{N_X} \dfrac{v_{N_X}-v_{{N_X}-1}}{\Delta} + \dfrac{\sigma_{N_X}^2}{2} \dfrac{-v_{N_X} + v_{{N_X}-1}}{\Delta^2}
\end{equation}
where we have used $\D_{x} v_{N_X} = \dfrac{v_{N_X+1}-v_{N_X}}{\Delta} = 0$ and hence $v_{N_X+1} = v_{N_X}$. \\
Note that here we defined the boundary conditions in terms of the value of points $v_0$ and $v_{N_X+1}$. These points are sometimes called "ghost nodes". \\
\\
Here, we make some variations to the simple option problem. When $\mu < 0$ is known, non-zero entries in the "upwind scheme" matrix become
\begin{align}
X_i &= -\dfrac{\mu_i}{\Delta} + \dfrac{\sigma_i^2}{2\Delta^2} \qquad \quad  i = 2, 3, ..., N_X \\
Y_i &= \dfrac{\mu_i}{\Delta} - \dfrac{\sigma_i^2}{\Delta^2} \qquad \qquad   i = 1, 2, ..., N_X-1 \\
Z_i &= \dfrac{\sigma_i^2}{2\Delta^2} \qquad  \qquad \qquad i = 1, 2, ..., N_X-1\\
Y_{N_X} & = \dfrac{\mu_{N_X}}{\Delta} - \dfrac{\sigma_{N_X}^2}{2\Delta^2}
\end{align}
The format of this varified matrix is the same as matrix $A$.




\bibliography{etk-references}

\end{document}